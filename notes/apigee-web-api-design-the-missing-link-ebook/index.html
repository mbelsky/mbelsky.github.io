<!doctype html><html lang=en-us>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover">
<title>Summary: Web Api Design the Missing Link | Max Belsky</title>
<meta name=description content="My summary for Web Api Design the Missing Link">
<meta name=author content="Max Belsky">
<link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png>
<link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png>
<link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png>
<link rel=manifest href=/site.webmanifest>
<link rel=stylesheet href=/css/reset.css>
<link rel=stylesheet href=/css/styles.css>
<meta property="og:title" content="Summary: Web Api Design the Missing Link">
<meta property="og:description" content="My summary for Web Api Design the Missing Link">
<meta property="og:type" content="article">
<meta property="og:url" content="https://www.mbelsky.com/notes/apigee-web-api-design-the-missing-link-ebook/"><meta property="og:image" content="https://www.mbelsky.com/android-chrome-192x192.png"><meta property="article:section" content="notes">
<meta property="article:published_time" content="2020-10-19T19:06:13+03:00">
<meta property="article:modified_time" content="2020-10-19T19:06:13+03:00">
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://www.mbelsky.com/android-chrome-192x192.png">
<meta name=twitter:title content="Summary: Web Api Design the Missing Link">
<meta name=twitter:description content="My summary for Web Api Design the Missing Link">
</head>
<body>
<div id=content>
<header class=single__header>
<h1 class=single__title__h1>Summary: Web Api Design the Missing Link</h1>
<time class=single__time datetime=2020-10-19>Oct 19, 2020</time>
</header>
<main class=single__main><p>The ebook: <a href=https://cloud.google.com/files/apigee/apigee-web-api-design-the-missing-link-ebook.pdf>.PDF</a></p>
<h2 id=relationship-between-models>Relationship between models</h2>
<p>Assume that there is a relationship between a dog and
its owner. A popular way to represent it:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json>{
  <span style=color:#f92672>&#34;id&#34;</span>: <span style=color:#e6db74>&#34;12345678&#34;</span>,
  <span style=color:#f92672>&#34;name&#34;</span>: <span style=color:#e6db74>&#34;Lassie&#34;</span>,
  <span style=color:#f92672>&#34;ownerID&#34;</span>: <span style=color:#e6db74>&#34;98765432&#34;</span> <span style=color:#75715e>// the relationship
</span><span style=color:#75715e></span>}
</code></pre></div><p>A better way:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json>{
  <span style=color:#f92672>&#34;id&#34;</span>: <span style=color:#e6db74>&#34;12345678&#34;</span>,
  <span style=color:#f92672>&#34;name&#34;</span>: <span style=color:#e6db74>&#34;Lassie&#34;</span>,
  <span style=color:#f92672>&#34;ownerID&#34;</span>: <span style=color:#e6db74>&#34;98765432&#34;</span>,
  <span style=color:#f92672>&#34;ownerLink&#34;</span>: <span style=color:#e6db74>&#34;https://dogtracker.com/persons/1337&#34;</span> <span style=color:#75715e>// Use links
</span><span style=color:#75715e></span>}
</code></pre></div><p>The owner representation:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json>{
  <span style=color:#f92672>&#34;id&#34;</span>: <span style=color:#e6db74>&#34;98765432&#34;</span>,
  <span style=color:#f92672>&#34;kind&#34;</span>: <span style=color:#e6db74>&#34;Person&#34;</span>,
  <span style=color:#f92672>&#34;name&#34;</span>: <span style=color:#e6db74>&#34;Joe Carraclough&#34;</span>,
  <span style=color:#f92672>&#34;dogsLink&#34;</span>: <span style=color:#e6db74>&#34;https://dogtracker.com/persons/98765432/dogs&#34;</span> <span style=color:#75715e>// üê∂
</span><span style=color:#75715e></span>}
</code></pre></div><p>Suppose dogs can be owned by either people or institutions (e.g. companies). At this point, it is no longer enough to have an <code>ownerID</code> property to reference the owner‚Äîyou also need to specify what type of owner it is.</p>
<p>Multiple solutions are possible:</p>
<ul>
<li>You could have <code>ownerID</code> and <code>ownerType</code> properties</li>
<li>you could have separate <code>personOwnerID</code> and <code>institutionalOwnerID</code> properties only one of which may be set at a time</li>
<li>you could invent a compound <code>owner</code> value that encoded both the type and the ID</li>
</ul>
<p>But a very elegant and flexible option is to use links to solve the problem:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json>{
  <span style=color:#f92672>&#34;self&#34;</span>: <span style=color:#e6db74>&#34;https://dogtracker.com/dogs/12345678&#34;</span>,
  <span style=color:#f92672>&#34;id&#34;</span>: <span style=color:#e6db74>&#34;12345678&#34;</span>,
  <span style=color:#f92672>&#34;kind&#34;</span>: <span style=color:#e6db74>&#34;Dog&#34;</span>,
  <span style=color:#f92672>&#34;name&#34;</span>: <span style=color:#e6db74>&#34;Lassie&#34;</span>,
  <span style=color:#f92672>&#34;owner&#34;</span>: <span style=color:#e6db74>&#34;https://dogtracker.com/persons/98765432&#34;</span>
}
</code></pre></div><blockquote>
<p>The server should strip the scheme and authority from URLs that identify its own resources before storing them, and put them back when they are requested. Any URLs that identify resources that are completely external to your API will probably have to be stored as absolute URLs. If you are not very experienced with absolute URLs in databases, don‚Äôt do it.</p>
</blockquote>
<h3 id=collections>Collections</h3>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json>{
  <span style=color:#f92672>&#34;self&#34;</span>: <span style=color:#e6db74>&#34;https://dogtracker.com/dogs&#34;</span>,
  <span style=color:#f92672>&#34;kind&#34;</span>: <span style=color:#e6db74>&#34;Collection&#34;</span>,
  <span style=color:#f92672>&#34;contents&#34;</span>: [
    {
      <span style=color:#f92672>&#34;self&#34;</span>: <span style=color:#e6db74>&#34;https://dogtracker.com/dogs/12344&#34;</span>,
      <span style=color:#f92672>&#34;kind&#34;</span>: <span style=color:#e6db74>&#34;Dog&#34;</span>,
      <span style=color:#f92672>&#34;name&#34;</span>: <span style=color:#e6db74>&#34;Fido&#34;</span>
    },
    {
      <span style=color:#f92672>&#34;self&#34;</span>: <span style=color:#e6db74>&#34;https://dogtracker.com/dogs/12345&#34;</span>,
      <span style=color:#f92672>&#34;kind&#34;</span>: <span style=color:#e6db74>&#34;Dog&#34;</span>,
      <span style=color:#f92672>&#34;name&#34;</span>: <span style=color:#e6db74>&#34;Rover&#34;</span>
    }
  ]
}
</code></pre></div><p>The <code>contents</code> field as an array of URLs would be another good option if your clients don&rsquo;t need any data about each of the content resources.</p>
<p><a href=http://amundsen.com/media-types/collection/format/>Collection+JSON</a></p>
<h3 id=paginated-collections>Paginated collections</h3>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>&gt;&gt;&gt;

GET /dogs HTTP/1.1
Host: dogtracker.com
Accept: application/json

<span style=color:#f92672>&lt;&lt;&lt;</span>

HTTP/1.1 <span style=color:#ae81ff>303</span> See Other
Location: https://dogtracker.com/dogs?limit<span style=color:#f92672>=</span>25,offset<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</code></pre></div><p>Response:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=color:#f92672>{</span>
  <span style=color:#e6db74>&#34;self&#34;</span>: <span style=color:#e6db74>&#34;https://dogtracker.com/dogs?limit=25,offset=0&#34;</span>,
  <span style=color:#e6db74>&#34;kind&#34;</span>: <span style=color:#e6db74>&#34;Page&#34;</span>,
  <span style=color:#e6db74>&#34;pageOf&#34;</span>: <span style=color:#e6db74>&#34;https://dogtracker.com/dogs&#34;</span>,
  <span style=color:#e6db74>&#34;next&#34;</span>: <span style=color:#e6db74>&#34;https://dogtracker.com/dogs?limit=25,offset=25&#34;</span>,
  // previous: URL
  // first: URL
  // last: URL
  <span style=color:#e6db74>&#34;contents&#34;</span>: <span style=color:#f92672>[</span>
    <span style=color:#f92672>{</span>
      <span style=color:#e6db74>&#34;self&#34;</span>: <span style=color:#e6db74>&#34;https://dogtracker.com/dogs/12344&#34;</span>,
      <span style=color:#e6db74>&#34;kind&#34;</span>: <span style=color:#e6db74>&#34;Dog&#34;</span>,
      <span style=color:#e6db74>&#34;name&#34;</span>: <span style=color:#e6db74>&#34;Fido&#34;</span>,
    <span style=color:#f92672>}</span>,
    <span style=color:#f92672>{</span>
      <span style=color:#e6db74>&#34;self&#34;</span>: <span style=color:#e6db74>&#34;https://dogtracker.com/dogs/12345&#34;</span>,
      <span style=color:#e6db74>&#34;kind&#34;</span>: <span style=color:#e6db74>&#34;Dog&#34;</span>,
      <span style=color:#e6db74>&#34;name&#34;</span>: <span style=color:#e6db74>&#34;Rover&#34;</span>,
    <span style=color:#f92672>}</span>
    // ‚Ä¶ <span style=color:#f92672>(</span><span style=color:#ae81ff>23</span> more<span style=color:#f92672>)</span>
  <span style=color:#f92672>]</span>
<span style=color:#f92672>}</span>
</code></pre></div><h2 id=designing-urls>Designing URLs</h2>
<p>In URLs, nouns are good; verbs are bad.</p>
<h3 id=path-parameters-or-matrix-parameters>Path parameters, or matrix parameters</h3>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>// Pattern

_/<span style=color:#f92672>{</span>relationship-name<span style=color:#f92672>}[</span>;<span style=color:#f92672>{</span>selector<span style=color:#f92672>}]</span>/‚Ä¶/<span style=color:#f92672>{</span>relationship-name<span style=color:#f92672>}[</span>;<span style=color:#f92672>{</span>selector<span style=color:#f92672>}]</span>_

// Examples

/persons;5678/dogs
/persons;id<span style=color:#f92672>=</span>5678/dogs <span style=color:#75715e># synonym for the previous URL</span>
/persons;name<span style=color:#f92672>=</span>JoeMCarraclough/dogs
</code></pre></div><h3 id=responses-that-dont-involve-persistent-resources>Responses that don‚Äôt involve persistent resources</h3>
<p>API calls that return a response that is not the representation of a persistent resource are common. In these cases, it is not necessary to depart from our noun-based, document-based model. The key insight is that the URL should identify the resource in the response, not the processing algorithm that calculates the response.</p>
<p>Examples:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>/monetary-amount?quantity<span style=color:#f92672>=</span>100&amp;unit<span style=color:#f92672>=</span>EUR&amp;in<span style=color:#f92672>=</span>CNY
/monetary-amount/100/EUR/CNY
</code></pre></div><h4 id=get-content-negotiation>GET content negotiation</h4>
<p>Req:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>GET /monetary-amount/100/EUR HTTP/1.1
Host: currency-converter.com
Accept-Currency:CNY
</code></pre></div><p>Res:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>683.92CNY
</code></pre></div><h4 id=post-noun-based>POST noun-based</h4>
<p>Req:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>POST /currency-converter HTTP/1.1

<span style=color:#f92672>{</span>
<span style=color:#e6db74>&#34;amount&#34;</span>: 100,
<span style=color:#e6db74>&#34;inputCurrency&#34;</span>: <span style=color:#e6db74>&#34;EUR&#34;</span>,
<span style=color:#e6db74>&#34;outputCurrency&#34;</span>: <span style=color:#e6db74>&#34;CNY&#34;</span>
<span style=color:#f92672>}</span>
</code></pre></div><p>Res:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>683.92
</code></pre></div><h3 id=partial-response>Partial response</h3>
<pre tabindex=0><code>/joe.smith/friends?fields=id,name,picture
</code></pre><h2 id=handling-errors->Handling Errors ??</h2>
<h2 id=modeling-actions->Modeling Actions ??</h2>
<h2 id=auth-oauth2-always>Auth: OAuth2 always</h2>
</main>
</div>
<footer>
<hr>
<div class=footer__links>
<a href=/>Home</a>
</div>
<span class=footer__license>
All code in this site is licensed under the MIT
license. All other content is licensed under the
<a href=https://creativecommons.org/licenses/by-nc-sa/4.0/ target=_blank>CC BY-NC-SA 4.0</a>
license.</span>
</footer>
</body>
</html>